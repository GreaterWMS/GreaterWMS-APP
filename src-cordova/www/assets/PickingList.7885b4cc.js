import{Q as m}from"./QItemLabel.58eb6bb3.js";import{Q as ie,a as X,b as A}from"./QList.3cc5bd82.js";import{_ as ce,az as de,J as ue,aP as re,r as Q,c as s,w as F,o as ge,M as V,V as I,f as t,R as o,b2 as me,F as L,S as r,U as c,X as Y,W as pe,b3 as fe,Y as H,$ as K,O as ve,m as O,b4 as he,aB as be,aA as _e}from"./index.08e92286.js";import{Q as ye,a as ke,b as Ce}from"./QBar.40c00dae.js";import{C as De}from"./ClosePopup.e29d3176.js";import{u as Se}from"./use-quasar.de271e6e.js";import{a as w}from"./index.2885cb15.js";import{u as $e}from"./vue-i18n.runtime.esm-bundler.114ddd7d.js";import"./selection.934c9d7f.js";const Qe=de({name:"ASNDetail",data(){return{}},setup(){const e=ue();re();const i=Se(),f=Q(0),g=Q({}),y=Q(!1),N=Q([]),{t:n}=$e(),k=s({get:()=>e.state.fabchange.fab1}),U=s({get:()=>e.state.fabchange.fab2}),Z=s({get:()=>e.state.fabchange.fab3}),x=s({get:()=>e.state.fabchange.fab4}),E=s({get:()=>e.state.screenchange.screenscroll}),M=s({get:()=>e.state.loginauth.authin}),P=s({get:()=>e.state.loginauth.login_name}),v=s({get:()=>e.state.loginauth.operator}),h=s({get:()=>e.state.settings.openid}),b=s({get:()=>e.state.langchange.lang}),p=s({get:()=>e.state.settings.server}),q=s({get:()=>e.state.scanchanged.scandata,set:a=>{e.commit("scanchanged/ScanChanged",a)}}),ee=s({get:()=>e.state.scanchanged.datadetail,set:a=>{e.commit("scanchanged/ScanDataChanged",a)}}),ae=s({get:()=>e.state.scanchanged.asndata,set:a=>{e.commit("scanchanged/ASNDataChanged",a)}}),te=s({get:()=>e.state.scanchanged.dndata,set:a=>{e.commit("scanchanged/DNDataChanged",a)}}),ne=s({get:()=>e.state.scanchanged.bindata,set:a=>{e.commit("scanchanged/BinDataChanged",a)}}),C=s({get:()=>e.state.scanchanged.tablelist,set:a=>{e.commit("scanchanged/TableDataChanged",a)}}),D=s({get:()=>e.state.scanchanged.scanmode,set:a=>{e.commit("scanchanged/ScanModeChanged",a)}}),j=s({get:()=>e.state.scanchanged.bar_scanned}),u=s({get:()=>e.state.scanchanged.apiurl,set:a=>{e.commit("scanchanged/ApiUrlChanged",a)}}),S=s({get:()=>e.state.scanchanged.apiurlnext,set:a=>{e.commit("scanchanged/ApiUrlNextChanged",a)}}),J=s({get:()=>e.state.scanchanged.apiurlprevious,set:a=>{e.commit("scanchanged/ApiUrlPreviousChanged",a)}});function R(a){if(a!==null){var l=p.value.split(":"),d=a.split(":");return l[0]!==d[0]?l[0]+":"+d[1]:d}else return null}function $(a){C.value=[],u.value=p.value+"dn/pickinglistfilter/?pick_qty__gt=0&picking_status=0",z(a)}function z(a){w.get(u.value+a,{headers:{"Content-Type":'application/json, charset="utf-8"',token:h.value,language:b.value,operator:v.value}}).then(l=>{if(l.data.detail)i.notify({type:"negative",message:n("notice.mobile_scan.notice1")});else{var d=[];C.value.forEach(_=>{d.push(_)}),l.data.results.forEach(_=>{d.push(_)}),C.value=d,J.value=R(l.data.previous),S.value=R(l.data.next)}}).catch(l=>{i.notify({type:"negative",message:n("notice.mobile_scan.notice3")})})}function se(a){g.value=JSON.parse(JSON.stringify(a)),y.value=!0}function G(){y.value=!1}function oe(a){u.value=p.value+"dn/list/?dn_code="+g.value.dn_code,w.get(u.value,{headers:{"Content-Type":'application/json, charset="utf-8"',token:h.value,language:b.value,operator:v.value}}).then(l=>{l.data.detail?i.notify({type:"negative",message:n("notice.mobile_scan.notice1")}):le(l.data.results[0])}).catch(l=>{i.notify({type:"negative",message:n("notice.mobile_scan.notice3")})})}function le(a){if(g.value.picked_qty===""||g.value.picked_qty===0)i.notify({type:"negative",message:"Please Enter the Bin Name"});else{u.value=p.value+"dn/picked/"+a.id+"/";const l={creater:P.value,customer:a.customer,dn_code:a.dn_code,goodsData:[g.value]};w.post(u.value,l,{headers:{"Content-Type":"application/json",token:h.value,language:b.value,operator:v.value}}).then(d=>{G(),$(""),d.data.detail||i.notify({message:"Success Move To Bin"})}).catch(d=>{i.notify({message:d.detail})})}}return F(j,(a,l)=>{D.value==="GOODS"?$("&goods_code="+q.value):D.value==="DN"&&$("&dn_code="+q.value)}),F(E,(a,l)=>{a===1?S.value!==null&&(u.value=S.value,f.value=1):f.value=0}),F(f,(a,l)=>{a===1&&(M.value==="0"?i.notify({type:"negative",message:n("notice.mobile_userlogin.notice9")}):z(""))}),ge(()=>{D.value="DN",$("")}),{t:n,fab1:k,fab2:U,fab3:Z,fab4:x,screenscroll:E,authin:M,login_name:P,openid:h,operator:v,lang:b,requestauth:f,baseurl:p,apiurl:u,apiurlnext:S,apiurlprevious:J,scandata:q,datadetail:ee,tablelist:C,asndata:ae,dndata:te,bindata:ne,scanmode:D,bar_scanned:j,submitdata:g,dialogForm:y,dataSubmit:se,cancelSubmitData:G,submitData:oe,options:N,error1:n("notice.mobile_asn.notice11"),filterFn(a,l,d){if(a.length<2){d();return}l(()=>{const _=a.toLowerCase();u.value=p.value+"binset/?bin_name__icontains=",w.get(u.value+a,{headers:{"Content-Type":'application/json, charset="utf-8"',token:h.value,language:b.value,operator:v.value}}).then(B=>{if(!B.data.detail){var W=[];B.data.results.forEach(T=>{W.push(T.bin_name)}),N.value=W.filter(T=>T.toLowerCase().indexOf(_)>-1)}}).catch(B=>{i.notify({type:"negative",message:n("notice.mobile_scan.notice3")})})})}}}}),Ve={style:{float:"right",padding:"15px 15px 15px 0"}};function we(e,i,f,g,y,N){return V(),I(L,null,[t(ie,{bordered:"",padding:""},{default:o(()=>[t(X,null,{default:o(()=>[t(A,null,{default:o(()=>[t(m,{overline:""},{default:o(()=>[r(c(e.$t("outbound.pickinglist")),1)]),_:1}),t(m,{caption:""},{default:o(()=>[r(c(e.$t("notice.mobile_asn.notice7")),1)]),_:1})]),_:1})]),_:1}),t(Y,{spaced:""}),t(m,{header:""},{default:o(()=>[r(c(e.$t("notice.mobile_asn.notice8")),1)]),_:1}),(V(!0),I(L,null,pe(e.tablelist,(n,k)=>(V(),I(L,{key:k},[t(X,null,{default:o(()=>[t(A,{onClick:U=>e.dataSubmit(n)},{default:o(()=>[t(m,null,{default:o(()=>[r(c(n.dn_code),1)]),_:2},1024),t(m,{caption:"",lines:"2"},{default:o(()=>[r(c(e.$t("goods.view_goodslist.goods_code"))+": "+c(n.goods_code),1)]),_:2},1024)]),_:2},1032,["onClick"]),t(A,{side:"",top:""},{default:o(()=>[t(m,{caption:""},{default:o(()=>[r(c(e.$t("notice.mobile_asn.notice9"))+c(n.bin_name),1)]),_:2},1024),t(m,{caption:""},{default:o(()=>[r(c(e.$t("notice.mobile_asn.notice10"))+c(n.pick_qty),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),K(t(Y,{spaced:"",inset:"item"},null,512),[[_e,k+1!==e.tablelist.length]])],64))),128))]),_:1}),t(me,{modelValue:e.dialogForm,"onUpdate:modelValue":i[2]||(i[2]=n=>e.dialogForm=n)},{default:o(()=>[t(fe,{class:"shadow-24"},{default:o(()=>[t(ye,{class:"bg-light-blue-10 text-white rounded-borders",style:{height:"50px"}},{default:o(()=>[H("div",null,c(e.submitdata.goods_code),1),t(ke),K((V(),ve(O,{dense:"",flat:"",icon:"close"},{default:o(()=>[t(Ce,null,{default:o(()=>[r(c(e.$t("index.close")),1)]),_:1})]),_:1})),[[De]])]),_:1}),t(he,{class:"scroll"},{default:o(()=>[t(be,{dense:"",outlined:"",square:"",debounce:"500",modelValue:e.submitdata.picked_qty,"onUpdate:modelValue":i[0]||(i[0]=n=>e.submitdata.picked_qty=n),modelModifiers:{number:!0},type:"number",label:e.$t("stock.view_stocklist.goods_qty"),style:{"margin-bottom":"5px"},onClick:i[1]||(i[1]=n=>e.submitdata.picked_qty=""),rules:[n=>n&&n>0||e.error1]},null,8,["modelValue","label","rules"])]),_:1}),H("div",Ve,[t(O,{color:"white","text-color":"black",style:{"margin-right":"25px"},onClick:e.cancelSubmitData},{default:o(()=>[r(c(e.$t("cancel")),1)]),_:1},8,["onClick"]),t(O,{color:"primary",onClick:e.submitData},{default:o(()=>[r(c(e.$t("submit")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"])],64)}var Ue=ce(Qe,[["render",we]]);export{Ue as default};
