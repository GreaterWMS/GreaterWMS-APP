import{Q as r}from"./QItemLabel.5952017e.js";import{Q as W,a as w,b as m}from"./QList.36844ce6.js";import{_ as X,aC as Y,J as Z,aR as K,r as x,c as s,G as ee,w as B,o as ae,M as b,Y as T,f as a,R as t,aS as te,F as I,W as i,X as o,$ as M,m as v,Z as ne,aT as se,V as O,S as R,O as oe,aU as le,aD as ie,a1 as ce}from"./index.4ba90dbb.js";import{Q as ue,a as de,b as re}from"./QBar.ca59454f.js";import{C as ge}from"./ClosePopup.38e9d4ed.js";import{u as fe}from"./use-quasar.1d9b433d.js";import{a as j}from"./index.33b22a2c.js";import{u as me}from"./vue-i18n.runtime.esm-bundler.3b9a62c7.js";import"./selection.9c5e1f92.js";import"./axios.b70a614d.js";const pe=Y({name:"HandCount",data(){return{}},setup(){const e=Z();K();const c=fe(),g=x(0),{t:f}=me(),U=s({get:()=>e.state.fabchange.fab1}),N=s({get:()=>e.state.fabchange.fab2}),l=s({get:()=>e.state.fabchange.fab3}),p=s({get:()=>e.state.fabchange.fab4}),h=s({get:()=>e.state.screenchange.screenscroll}),_=s({get:()=>e.state.loginauth.authin}),E=s({get:()=>e.state.loginauth.login_name}),y=s({get:()=>e.state.loginauth.operator}),C=s({get:()=>e.state.settings.openid}),$=s({get:()=>e.state.langchange.lang}),V=s({get:()=>e.state.settings.server}),D=s({get:()=>e.state.scanchanged.scandata,set:n=>{e.commit("scanchanged/ScanChanged",n)}}),F=s({get:()=>e.state.scanchanged.datadetail,set:n=>{e.commit("scanchanged/ScanDataChanged",n)}}),G=s({get:()=>e.state.scanchanged.dndata,set:n=>{e.commit("scanchanged/DNDataChanged",n)}}),H=s({get:()=>e.state.scanchanged.bindata,set:n=>{e.commit("scanchanged/BinDataChanged",n)}}),P=s({get:()=>e.state.scanchanged.tablelist,set:n=>{e.commit("scanchanged/TableDataChanged",n)}}),Q=s({get:()=>e.state.scanchanged.scanmode}),A=s({get:()=>e.state.scanchanged.bar_scanned}),q=s({get:()=>e.state.scanchanged.apiurl,set:n=>{e.commit("scanchanged/ApiUrlChanged",n)}}),S=s({get:()=>e.state.scanchanged.apiurlnext,set:n=>{e.commit("scanchanged/ApiUrlNextChanged",n)}}),z=s({get:()=>e.state.scanchanged.apiurlprevious,set:n=>{e.commit("scanchanged/ApiUrlPreviousChanged",n)}}),u=ee({tableData:[],bin_name:"",goods_code:"",affirmresultVisible:!1});function k(){u.tableData=[],L()}function L(n){j.get(V.value+`cyclecount/manualcyclecount/?bin_name=${u.bin_name}&goods_code=${u.goods_code}`,{headers:{"Content-Type":'application/json, charset="utf-8"',token:C.value,language:$.value,operator:y.value}}).then(d=>{d.data&&d.data.length>0&&(u.tableData=d.data)})}function J(){j.post(V.value+"cyclecount/manualcyclecount/",u.tableData,{headers:{"Content-Type":"application/json",token:C.value,language:$.value,operator:y.value}}).then(n=>{c.notify({message:f("notice.handcount.notice7")}),u.affirmresultVisible=!1,k()})}return B(A,(n,d)=>{Q.value==="GOODS"&&(u.goods_code=D.value),Q.value==="BINSET"&&(u.bin_name=D.value),k()}),B(h,(n,d)=>{n===1?S.value!==null&&(q.value=S.value,g.value=1):g.value=0}),B(g,(n,d)=>{n===1&&(_.value==="0"?c.notify({type:"negative",message:f("notice.mobile_userlogin.notice9")}):L())}),ae(()=>{_.value==="0"?c.notify({type:"negative",message:f("notice.mobile_userlogin.notice9")}):k()}),{state:u,t:f,fab1:U,fab2:N,fab3:l,fab4:p,screenscroll:h,authin:_,login_name:E,openid:C,operator:y,lang:$,requestauth:g,baseurl:V,apiurl:q,apiurlnext:S,apiurlprevious:z,scandata:D,datadetail:F,tablelist:P,dndata:G,bindata:H,scanmode:Q,bar_scanned:A,handleAffirmresultSubmit:J}}}),he={style:{float:"right",padding:"15px"}};function be(e,c,g,f,U,N){return b(),T(I,null,[a(W,{bordered:"",padding:""},{default:t(()=>[a(w,null,{default:t(()=>[a(m,null,{default:t(()=>[a(r,{overline:""},{default:t(()=>[i(o(e.$t("notice.handcount.notice2")),1)]),_:1}),a(r,{caption:""},{default:t(()=>[i(o(e.$t("notice.handcount.notice8")),1)]),_:1})]),_:1})]),_:1}),a(M,{spaced:""}),a(w,null,{default:t(()=>[a(m,null,{default:t(()=>[i(o(e.$t("notice.handcount.notice1")),1)]),_:1}),a(m,{side:""},{default:t(()=>[a(v,{onClick:c[0]||(c[0]=l=>e.state.affirmresultVisible=!0),color:"primary",size:"sm"},{default:t(()=>[i(o(e.$t("notice.handcount.notice5")),1)]),_:1})]),_:1})]),_:1}),(b(!0),T(I,null,ne(e.state.tableData,(l,p)=>(b(),T(I,{key:p},[a(w,null,{default:t(()=>[a(m,null,{default:t(()=>[a(r,null,{default:t(()=>[i(o(l.bin_name),1)]),_:2},1024),a(r,{caption:"",lines:"2"},{default:t(()=>[i(o(l.goods_code),1)]),_:2},1024)]),_:2},1024),a(m,{side:"",top:""},{default:t(()=>[a(r,{caption:""},{default:t(()=>[i(o(e.$t("notice.handcount.notice3"))+"\uFF1A"+o(l.goods_qty),1)]),_:2},1024),a(r,{caption:""},{default:t(()=>[a(ie,{dense:"",outlined:"",square:"",modelValue:l.physical_inventory,"onUpdate:modelValue":h=>l.physical_inventory=h,modelModifiers:{number:!0},type:"number",style:{width:"100px"},label:e.$t("notice.handcount.notice4")},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024)]),_:2},1024)]),_:2},1024),R(a(M,{spaced:"",inset:"item"},null,512),[[ce,p+1!==e.state.tableData.length]])],64))),128))]),_:1}),a(te,{modelValue:e.state.affirmresultVisible,"onUpdate:modelValue":c[2]||(c[2]=l=>e.state.affirmresultVisible=l)},{default:t(()=>[a(se,{class:"shadow-24"},{default:t(()=>[a(ue,{class:"bg-light-blue-10 text-white rounded-borders",style:{height:"50px"}},{default:t(()=>[O("div",null,o(e.$t("notice.handcount.notice6")),1),a(de),R((b(),oe(v,{dense:"",flat:"",icon:"close"},{default:t(()=>[a(re,null,{default:t(()=>[i(o(e.$t("index.close")),1)]),_:1})]),_:1})),[[ge]])]),_:1}),a(le,{class:"scroll"},{default:t(()=>[i(o(e.$t("deletetip")),1)]),_:1}),O("div",he,[a(v,{color:"white","text-color":"black",style:{"margin-right":"25px"},onClick:c[1]||(c[1]=l=>e.state.affirmresultVisible=!1)},{default:t(()=>[i(o(e.$t("cancel")),1)]),_:1}),a(v,{color:"primary",onClick:e.handleAffirmresultSubmit},{default:t(()=>[i(o(e.$t("submit")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"])],64)}var we=X(pe,[["render",be]]);export{we as default};
