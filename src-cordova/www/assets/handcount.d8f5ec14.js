import{Q as g}from"./QItemLabel.f2ca9cdb.js";import{Q as pe,a as w,b as p}from"./QList.d1851a4f.js";import{_ as be,az as he,J as ve,aP as ye,r as Q,c as s,G as Ce,w as A,o as _e,M as _,V as F,f as a,R as t,aR as z,F as K,S as u,U as i,X as G,m,W as Ve,aS as H,Y as S,$ as L,O as W,aT as X,aB as Y,aU as $e,Q as ke,aV as we,aA as Qe}from"./index.dfd0e5e3.js";import{Q as Z,a as x,b as ee}from"./QBar.136bca6b.js";import{Q as Se}from"./QSelect.5f57161a.js";import{C as ae}from"./ClosePopup.ea049126.js";import{u as De}from"./use-quasar.144b8dba.js";import{a as D}from"./index.2885cb15.js";import{u as Be}from"./vue-i18n.runtime.esm-bundler.c4f8fc63.js";import"./selection.e5845525.js";import"./QMenu.30ec175d.js";import"./rtl.b51694b1.js";import"./format.a33550d6.js";const Te=he({name:"HandCount",data(){return{}},setup(){const e=ve();ye();const o=De(),b=Q(0),c=Q({}),V=Q(!1),B=Q([]),{t:l}=Be(),$=s({get:()=>e.state.fabchange.fab1}),T=s({get:()=>e.state.fabchange.fab2}),te=s({get:()=>e.state.fabchange.fab3}),ne=s({get:()=>e.state.fabchange.fab4}),M=s({get:()=>e.state.screenchange.screenscroll}),j=s({get:()=>e.state.loginauth.authin}),le=s({get:()=>e.state.loginauth.login_name}),h=s({get:()=>e.state.loginauth.operator}),v=s({get:()=>e.state.settings.openid}),y=s({get:()=>e.state.langchange.lang}),C=s({get:()=>e.state.settings.server}),q=s({get:()=>e.state.scanchanged.scandata,set:n=>{e.commit("scanchanged/ScanChanged",n)}}),oe=s({get:()=>e.state.scanchanged.datadetail,set:n=>{e.commit("scanchanged/ScanDataChanged",n)}}),se=s({get:()=>e.state.scanchanged.dndata,set:n=>{e.commit("scanchanged/DNDataChanged",n)}}),ie=s({get:()=>e.state.scanchanged.bindata,set:n=>{e.commit("scanchanged/BinDataChanged",n)}}),ue=s({get:()=>e.state.scanchanged.tablelist,set:n=>{e.commit("scanchanged/TableDataChanged",n)}}),U=s({get:()=>e.state.scanchanged.scanmode}),E=s({get:()=>e.state.scanchanged.bar_scanned}),f=s({get:()=>e.state.scanchanged.apiurl,set:n=>{e.commit("scanchanged/ApiUrlChanged",n)}}),N=s({get:()=>e.state.scanchanged.apiurlnext,set:n=>{e.commit("scanchanged/ApiUrlNextChanged",n)}}),de=s({get:()=>e.state.scanchanged.apiurlprevious,set:n=>{e.commit("scanchanged/ApiUrlPreviousChanged",n)}}),d=Ce({tableData:[],bin_name:"",goods_code:"",affirmresultVisible:!1});function k(){d.tableData=[],P()}function P(n){D.get(C.value+`cyclecount/manualcyclecount/?bin_name=${d.bin_name}&goods_code=${d.goods_code}`,{headers:{"Content-Type":'application/json, charset="utf-8"',token:v.value,language:y.value,operator:h.value}}).then(r=>{console.log(r.data,"------"),r.data&&r.data.length>0&&(d.tableData=r.data)})}function re(n){c.value=JSON.parse(JSON.stringify(n)),Object.assign(c.value,{qty:"",bin_name:""}),V.value=!0}function J(){V.value=!1}function ce(){c.value.bin_name===""?o.notify({type:"negative",message:"Please Enter the Bin Name"}):(f.value=C.value+"asn/movetobin/",D.post(f.value+c.value.id+"/",c.value,{headers:{"Content-Type":"application/json",token:v.value,language:y.value,operator:h.value}}).then(n=>{J(),k(),n.data.detail||o.notify({message:"Success Move To Bin"})}).catch(n=>{o.notify({message:n.detail})}))}function me(){console.log(d.tableData),D.post(C.value+"cyclecount/manualcyclecount/",d.tableData,{headers:{"Content-Type":"application/json",token:v.value,language:y.value,operator:h.value}}).then(n=>{o.notify({message:"Success Confirm Cycle Count",icon:"check",color:"green"}),d.affirmresultVisible=!1,k()})}return A(E,(n,r)=>{console.log(8888),U.value==="GOODS"&&(d.goods_code=q.value),U.value==="BINSET"&&(d.bin_name=q.value),k()}),A(M,(n,r)=>{n===1?N.value!==null&&(f.value=N.value,b.value=1):b.value=0}),A(b,(n,r)=>{n===1&&(j.value==="0"?o.notify({type:"negative",message:l("notice.mobile_userlogin.notice9")}):P())}),_e(()=>{k()}),{state:d,t:l,fab1:$,fab2:T,fab3:te,fab4:ne,screenscroll:M,authin:j,login_name:le,openid:v,operator:h,lang:y,requestauth:b,baseurl:C,apiurl:f,apiurlnext:N,apiurlprevious:de,scandata:q,datadetail:oe,tablelist:ue,dndata:se,bindata:ie,scanmode:U,bar_scanned:E,submitdata:c,uploaddialog:V,upLoadToBin:re,cancelToBin:J,submitToBin:ce,options:B,handleAffirmresultSubmit:me,moveerror:l("notice.mobile_asn.notice11"),filterFn(n,r,fe){if(n.length<2){fe();return}r(()=>{const ge=n.toLowerCase();f.value=C.value+"binset/?bin_name__icontains=",D.get(f.value+n,{headers:{"Content-Type":'application/json, charset="utf-8"',token:v.value,language:y.value,operator:h.value}}).then(I=>{if(!I.data.detail){var R=[];I.data.results.forEach(O=>{R.push(O.bin_name)}),B.value=R.filter(O=>O.toLowerCase().indexOf(ge)>-1)}}).catch(I=>{o.notify({type:"negative",message:l("notice.mobile_scan.notice3")})})})}}}}),qe={style:{float:"right",padding:"15px 15px 15px 0"}},Ue={style:{float:"right",padding:"15px"}};function Ne(e,o,b,c,V,B){return _(),F(K,null,[a(pe,{bordered:"",padding:""},{default:t(()=>[a(w,null,{default:t(()=>[a(p,null,{default:t(()=>[a(g,{overline:""},{default:t(()=>[u(i(e.$t("twoKai.tabname")),1)]),_:1}),a(g,{caption:""},{default:t(()=>[u(i(e.$t("notice.mobile_asn.notice7")),1)]),_:1})]),_:1})]),_:1}),a(G,{spaced:""}),a(w,null,{default:t(()=>[a(p,null,{default:t(()=>[u(i(e.$t("twoKai.particulars")),1)]),_:1}),a(p,{side:""},{default:t(()=>[a(m,{onClick:o[0]||(o[0]=l=>e.state.affirmresultVisible=!0),color:"primary",size:"sm"},{default:t(()=>[u(i(e.$t("twoKai.affirmresult")),1)]),_:1})]),_:1})]),_:1}),(_(!0),F(K,null,Ve(e.state.tableData,(l,$)=>(_(),F(K,{key:$},[a(w,null,{default:t(()=>[a(p,null,{default:t(()=>[a(g,null,{default:t(()=>[u(i(l.bin_name),1)]),_:2},1024),a(g,{caption:"",lines:"2"},{default:t(()=>[u(i(l.goods_code),1)]),_:2},1024)]),_:2},1024),a(p,{side:"",top:""},{default:t(()=>[a(g,{caption:""},{default:t(()=>[u(i(e.$t("twoKai.tablekucun"))+"\uFF1A"+i(l.goods_qty),1)]),_:2},1024),a(g,{caption:""},{default:t(()=>[a(Y,{dense:"",outlined:"",square:"",modelValue:l.physical_inventory,"onUpdate:modelValue":T=>l.physical_inventory=T,modelModifiers:{number:!0},type:"number",style:{width:"100px"},label:e.$t("twoKai.tablepandiannum")},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024)]),_:2},1024)]),_:2},1024),L(a(G,{spaced:"",inset:"item"},null,512),[[Qe,$+1!==e.state.tableData.length]])],64))),128))]),_:1}),a(z,{modelValue:e.uploaddialog,"onUpdate:modelValue":o[5]||(o[5]=l=>e.uploaddialog=l)},{default:t(()=>[a(H,{class:"shadow-24"},{default:t(()=>[a(Z,{class:"bg-light-blue-10 text-white rounded-borders",style:{height:"50px"}},{default:t(()=>[S("div",null,i(e.submitdata.goods_code),1),a(x),L((_(),W(m,{dense:"",flat:"",icon:"close"},{default:t(()=>[a(ee,null,{default:t(()=>[u(i(e.$t("index.close")),1)]),_:1})]),_:1})),[[ae]])]),_:1}),a(X,{class:"scroll"},{default:t(()=>[a(Y,{dense:"",outlined:"",square:"",debounce:"500",modelValue:e.submitdata.qty,"onUpdate:modelValue":o[3]||(o[3]=l=>e.submitdata.qty=l),modelModifiers:{number:!0},type:"number",label:e.$t("stock.view_stocklist.goods_qty"),style:{"margin-bottom":"5px"},onClick:o[4]||(o[4]=l=>e.submitdata.qty=""),rules:[l=>l&&l>0||e.moveerror]},{before:t(()=>[a(Se,{dense:"",outlined:"",square:"","use-input":"","hide-selected":"","fill-input":"",modelValue:e.submitdata.bin_name,"onUpdate:modelValue":o[2]||(o[2]=l=>e.submitdata.bin_name=l),label:e.$t("warehouse.view_binset.bin_name"),options:e.options,onFilter:e.filterFn,style:{width:"150px"}},$e({"no-option":t(()=>[a(w,null,{default:t(()=>[a(p,{class:"text-grey"},{default:t(()=>[u(" No results ")]),_:1})]),_:1})]),_:2},[e.submitdata.bin_name?{name:"append",fn:t(()=>[a(ke,{name:"cancel",onClick:o[1]||(o[1]=we(l=>e.submitdata.bin_name="",["stop"])),class:"cursor-pointer"})]),key:"0"}:void 0]),1032,["modelValue","label","options","onFilter"])]),_:1},8,["modelValue","label","rules"])]),_:1}),S("div",qe,[a(m,{color:"white","text-color":"black",style:{"margin-right":"25px"},onClick:e.cancelToBin},{default:t(()=>[u(i(e.$t("cancel")),1)]),_:1},8,["onClick"]),a(m,{color:"primary",onClick:e.submitToBin},{default:t(()=>[u(i(e.$t("submit")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:e.state.affirmresultVisible,"onUpdate:modelValue":o[7]||(o[7]=l=>e.state.affirmresultVisible=l)},{default:t(()=>[a(H,{class:"shadow-24"},{default:t(()=>[a(Z,{class:"bg-light-blue-10 text-white rounded-borders",style:{height:"50px"}},{default:t(()=>[S("div",null,i(e.$t("twoKai.affirmcheckresult")),1),a(x),L((_(),W(m,{dense:"",flat:"",icon:"close"},{default:t(()=>[a(ee,null,{default:t(()=>[u(i(e.$t("index.close")),1)]),_:1})]),_:1})),[[ae]])]),_:1}),a(X,{class:"scroll"},{default:t(()=>[u(" \u6B64\u64CD\u4F5C\u4E0D\u53EF\u9006\u3002 ")]),_:1}),S("div",Ue,[a(m,{color:"white","text-color":"black",style:{"margin-right":"25px"},onClick:o[6]||(o[6]=l=>e.state.affirmresultVisible=!1)},{default:t(()=>[u(i(e.$t("cancel")),1)]),_:1}),a(m,{color:"primary",onClick:e.handleAffirmresultSubmit},{default:t(()=>[u(i(e.$t("submit")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"])],64)}var Ge=be(Te,[["render",Ne]]);export{Ge as default};
